# まとめ
- 運用上の注意点
	- ユニークにするとインデックスを貼ることになる
		- ユニークであるかの検証にインデックスが必要になるから
	- ユニークにするとINSERTが重たくなる
		- どんなもん？
	- ユニーク制約の回避方法
		- アプリケーションで実装してしまう
		- 先にSELECTする
	- 変更バッファを無効にする
		- 実装を考えた時にそうなる。これはインデックスが貼られるとかINSERTが重くなるとかと通じる、背景と仕組みの話
	- 




# ログ
- UNIQUE制約の理解が甘くて二重にインデックスを張りそうになった件
	- https://developers.techouse.com/entry/unique-index-conflict
	- インデックスとユニーク制約がぶつかったという記事
		- ユニーク制約はインデックス必要だからね基本
	- どちらかがあれば速度は出る（インデックスがある）ことの調査
	- 両方あるとINSERTが遅くなることの調査
- PostgreSQLで組み合わせでのユニーク制約をつけた場合の、INSERT方法のパフォーマンス比較
	- https://qiita.com/The_Past_of_Dice/items/0b0b2933121f25700981
		- ポスぐれだけど。Unique制約をかけた時の速度比較
		- INSERTするときに他に同じ値を使っているものがないか検証してから流す、という方法だったり、事前にSELECTしたり、まあとにかくユニークを担保するためにはいろんなやり方があるという話
		- それをそれぞれ速度比較している
	- 感想
		- アプリケーション層での考慮の仕方を知らなかったので面白かった
		- DBレイヤーでユニークを担保するという意味では、速度を犠牲にしてでもやった方がいいと思う
		- アプリケーションで検査すればいい、だと運用とかで崩れるからね
- 一意な値を格納するカラムには、UNIQUE制約を必ずつけた方が良いですか？
	- https://ja.stackoverflow.com/questions/63464
		- 何のためにつけるの？　つけない方がいいことはあるの？
		- システム上意味がないならつけなくていいという回答
	- 感想
		- 意味がない、というのがどれくらいの意味なのか考えたいなと思った
		- ほんとに重複しうるって意味なのか、重複を気にしなくていいって位なのか、など
- ユニークキーのパフォーマンス
	- https://next4us-ti.hatenablog.com/entry/2018/11/16/153855
		- ユニークキーをつけた時と、シンプルなインデックスの時の性能差を見ている
		- MySQL８系
		- INSERTは大量データでない限り、ユニークだから遅くなるって感じじゃない。インデックスあるならその分遅いって感じ。
	- `SHOW SESSION STATUS LIKE 'handler%';`
		- これを実施すると、セッションの中で対象のハンドラAPIがどれくらい呼ばれたかわかるらしい
		- 実行計画をみるのも大事だし、これを見てみて実際にどれくらいAPIが呼ばれてるのか見るのも良さそう
	- チェンジバッファ機能を無効にしてしまうUNIQUEキー
		- このチェンジバッファ機能ってのが何なのかわからんな
			- https://dev.mysql.com/doc/refman/8.0/ja/innodb-change-buffer.html
			- これは読もう
- 15.5.2 変更バッファ
	- https://dev.mysql.com/doc/refman/8.0/ja/innodb-change-buffer.html
	- すでに存在するかどうかの制約だから、どうせテーブルを見にいくなら修正していいでしょって話か？


